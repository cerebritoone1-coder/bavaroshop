{% extends "base.html" %}

{% block content %}
<div style="display:flex; justify-content:center; padding:60px 20px;">

    <div style="width:100%; max-width:900px;">

        <h2 style="margin-bottom:40px; text-align:center;"></h2>

        {% for pedido in pedidos %}
        <div style="
            background:rgba(255,255,255,0.08);
            padding:30px;
            border-radius:14px;
            margin-bottom:30px;
            color:white;
            box-shadow:0 10px 25px rgba(0,0,0,0.25);
        ">

            <!-- ENCABEZADO -->
            <div style="display:flex; justify-content:space-between; margin-bottom:20px;">
                <div>
                    <strong style="font-size:18px;">Pedido #{{ pedido.id }}</strong><br>
                    {{ pedido.created_at|date:"d M Y - H:i" }}
                </div>

                <div style="text-align:right;">
                    Estado: {{ pedido.status }}<br>
                    <strong style="font-size:16px;">Total: RD$ {{ pedido.total_amount }}</strong>
                </div>
            </div>

            <hr style="opacity:0.2; margin:20px 0;">

            <!-- PRODUCTOS -->
            <div>
                <strong style="font-size:16px;">Productos:</strong><br><br>

                {% for item in pedido.items.all %}
                <div style="
                    display:flex;
                    gap:20px;
                    margin-bottom:20px;
                    align-items:center;
                    background:rgba(255,255,255,0.05);
                    padding:15px;
                    border-radius:10px;
                ">

                    <!-- IMAGEN -->
                    {% if item.product.image %}
                        <img src="{{ item.product.image.url }}"
                             style="width:90px; height:90px; object-fit:cover; border-radius:10px;">
                    {% else %}
                        <div style="
                            width:90px;
                            height:90px;
                            background:rgba(255,255,255,0.1);
                            display:flex;
                            align-items:center;
                            justify-content:center;
                            border-radius:10px;
                            font-size:12px;
                        ">
                            Sin imagen
                        </div>
                    {% endif %}

                    <!-- INFO -->
                    <div style="flex:1;">
                        <strong style="font-size:16px;">{{ item.product.name }}</strong><br>
                        Cantidad: {{ item.quantity }}<br>
                        Precio: RD$ {{ item.price }}
                    </div>

                </div>
                {% endfor %}
            </div>

            <!-- BOTÓN ELIMINAR -->
            <div style="text-align:right; margin-top:20px;">
                <form method="POST" action="{% url 'eliminar_pedido' pedido.id %}">
                    {% csrf_token %}
                    <button type="submit"
                        style="
                            background:#dc3545;
                            border:none;
                            padding:10px 20px;
                            border-radius:8px;
                            color:white;
                            cursor:pointer;
                            font-weight:600;
                        ">
                        Eliminar pedido
                    </button>
                </form>
            </div>

        </div>
        {% empty %}
            <p style="text-align:center;">No tienes pedidos aún.</p>
        {% endfor %}

    </div>

</div>
{% endblock %}
